CREATE PROCEDURE [Test].[FinalResult] 
AS 
drop table if exists ##ResToCsv
;with W as 
(
 select *,dateadd(DAY,6,Endt) as WToDate from ResW
),
H4 as 
(
	select *,FORMAT(cast([Time] as DateTime),'HH:mm') as FromHH,FORMAT(dateadd(HOUR,3,cast([Time] as DateTime)),'HH:59') as ToHH
	from ResH4
)
,H1 as 
(
	select *,FORMAT(cast([Time] as DateTime),'HH:mm') as FromHH,FORMAT(cast([Time] as DateTime),'HH:59') as ToHH
	from ResH1
)
select 
w.[RowNo] as [Week_RowNo],
w.[Open] as [Week_Open],
w.[High] as [Week_High],
w.[Low] as [Week_Low],
w.[Close] as [Week_Close],
w.[CandleCeiling] as [Week_CandleCeiling],
w.[CandleFloor] as [Week_CandleFloor],
w.[Volume] as [Week_Volume],
w.[DateID] as [Week_DateID],
w.[MaxBetween] as [Week_MaxBetween],
w.[MinBetween] as [Week_MinBetween],
w.[Endt] as [Week_Endt],
w.[MX] as [Week_MX],
w.[Min] as [Week_Min],
w.[EnDay] as [Week_EnDay],
w.[EnMonthName] as [Week_EnMonthName],
w.[EnYear] as [Week_EnYear],
w.[lgMax] as [Week_lgMax],
w.[LgMin] as [Week_LgMin],
w.[ClosePriceDiffLgMin] as [Week_ClosePriceDiffLgMin],
w.[ClosePriceDiffLgMax] as [Week_ClosePriceDiffLgMax],
w.[HighPriceDiffLgMin] as [Week_HighPriceDiffLgMin],
w.[HighPriceDiffLgMax] as [Week_HighPriceDiffLgMax],
w.[LowPriceDiffLgMin] as [Week_LowPriceDiffLgMin],
w.[LowPriceDiffLgMax] as [Week_LowPriceDiffLgMax],
w.[CandleDiffFromLagMaxPivot] as [Week_CandleDiffFromLagMaxPivot],
w.[CandleDiffFromLagMinPivot] as [Week_CandleDiffFromLagMinPivot],
w.[PivotToPivotMaxDegree] as [Week_PivotToPivotMaxDegree],
w.[PivotToPivotMinDegree] as [Week_PivotToPivotMinDegree],
w.[PivotToCurrentMaxDegree] as [Week_PivotToCurrentMaxDegree],
w.[PivotToCurrentMinDegree] as [Week_PivotToCurrentMinDegree],
w.[VolLagPercent] as [Week_VolLagPercent],
w.[RSI14] as [Week_RSI14],
w.[RSI5] as [Week_RSI5],
w.[ID] as [Week_ID],
w.[OBV] as [Week_OBV],
w.[CCI] as [Week_CCI],
w.[+Di14] as [Week_+Di14],
w.[-Di14] as [Week_-Di14],
w.[ADX] as [Week_ADX],
w.[IsBiggerThanMaxPrice3] as [Week_IsBiggerThanMaxPrice3],
w.[IsBiggerThanMaxPrice5] as [Week_IsBiggerThanMaxPrice5],
w.[IsBiggerThanMaxPrice8] as [Week_IsBiggerThanMaxPrice8],
w.[IsBiggerThanMaxPrice13] as [Week_IsBiggerThanMaxPrice13],
w.[IsBiggerThanMaxPrice34] as [Week_IsBiggerThanMaxPrice34],
w.[IsLessThanMinPrice3] as [Week_IsLessThanMinPrice3],
w.[IsLessThanMinPrice5] as [Week_IsLessThanMinPrice5],
w.[IsLessThanMinPrice8] as [Week_IsLessThanMinPrice8],
w.[IsLessThanMinPrice13] as [Week_IsLessThanMinPrice13],
w.[IsLessThanMinPrice34] as [Week_IsLessThanMinPrice34],
w.[ResistantDistanceMaxPrice3] as [Week_ResistantDistanceMaxPrice3],
w.[ResistantDistancePrice5] as [Week_ResistantDistancePrice5],
w.[ResistantDistancePrice8] as [Week_ResistantDistancePrice8],
w.[ResistantDistancePrice13] as [Week_ResistantDistancePrice13],
w.[ResistantDistancePrice34] as [Week_ResistantDistancePrice34],
w.[SupportDistanceMinPrice3] as [Week_SupportDistanceMinPrice3],
w.[SupportDistanceMinPrice5] as [Week_SupportDistanceMinPrice5],
w.[SupportDistanceMinPrice8] as [Week_SupportDistanceMinPrice8],
w.[SupportDistanceMinPrice13] as [Week_SupportDistanceMinPrice13],
w.[SupportDistanceMinPrice34] as [Week_SupportDistanceMinPrice34],
w.[SMA] as [Week_SMA],
w.[EMA] as [Week_EMA],
w.[DiffSmaEmaOverClosePrcnt] as [Week_DiffSmaEmaOverClosePrcnt],
w.[IsSmaOveEma] as [Week_IsSmaOveEma],
w.[SmaDegree] as [Week_SmaDegree],
w.[EmaDegree] as [Week_EmaDegree],
w.[IsRed] as [Week_IsRed],
w.[IsGreen] as [Week_IsGreen],
w.[_PriceRange] as [Week__PriceRange],
w.[PriceRangeWidthPrcnt] as [Week_PriceRangeWidthPrcnt],
w.[MiddleBodyPrice] as [Week_MiddleBodyPrice],
w.[MiddleFullPrice] as [Week_MiddleFullPrice],
w.[ResistantDistancePrcnt] as [Week_ResistantDistancePrcnt],
w.[SupportDistancePrcnt] as [Week_SupportDistancePrcnt],
w.[FloorToCieling] as [Week_FloorToCieling],
w.[CandleBodyRangeWidthPrcnt] as [Week_CandleBodyRangeWidthPrcnt],
w.[_CloseOpenPrcnt] as [Week__CloseOpenPrcnt],
w.[_HighCielingPrcnt] as [Week__HighCielingPrcnt],
w.[_FloorLowPrcnt] as [Week__FloorLowPrcnt],
w.[OneLagIsRed] as [Week_OneLagIsRed],
w.[OneLagIsGreen] as [Week_OneLagIsGreen],
w.[OneLagCandleCeiling] as [Week_OneLagCandleCeiling],
w.[OneLagCandleFloor] as [Week_OneLagCandleFloor],
w.[OneLagHigh] as [Week_OneLagHigh],
w.[OneLagLow] as [Week_OneLagLow],
w.[OneCandleBodyRangeWidthPrcnt] as [Week_OneCandleBodyRangeWidthPrcnt],
w.[OneFloorToCieling] as [Week_OneFloorToCieling],
w.[MonsterCandle_Bullish] as [Week_MonsterCandle_Bullish],
w.[MonsterCandle_Bearish] as [Week_MonsterCandle_Bearish],
w.[UHAMMER] as [Week_UHAMMER],
w.[LHAMMER] as [Week_LHAMMER],
w.[IsSharkZone] as [Week_IsSharkZone],
D.[RowNo] as [Daily_RowNo],
D.[Open] as [Daily_Open],
D.[High] as [Daily_High],
D.[Low] as [Daily_Low],
D.[Close] as [Daily_Close],
D.[CandleCeiling] as [Daily_CandleCeiling],
D.[CandleFloor] as [Daily_CandleFloor],
D.[Volume] as [Daily_Volume],
D.[DateID] as [Daily_DateID],
D.[MaxBetween] as [Daily_MaxBetween],
D.[MinBetween] as [Daily_MinBetween],
D.[Endt] as [Daily_Endt],
D.[MX] as [Daily_MX],
D.[Min] as [Daily_Min],
D.[EnDay] as [Daily_EnDay],
D.[EnMonthName] as [Daily_EnMonthName],
D.[EnYear] as [Daily_EnYear],
D.[lgMax] as [Daily_lgMax],
D.[LgMin] as [Daily_LgMin],
D.[ClosePriceDiffLgMin] as [Daily_ClosePriceDiffLgMin],
D.[ClosePriceDiffLgMax] as [Daily_ClosePriceDiffLgMax],
D.[HighPriceDiffLgMin] as [Daily_HighPriceDiffLgMin],
D.[HighPriceDiffLgMax] as [Daily_HighPriceDiffLgMax],
D.[LowPriceDiffLgMin] as [Daily_LowPriceDiffLgMin],
D.[LowPriceDiffLgMax] as [Daily_LowPriceDiffLgMax],
D.[CandleDiffFromLagMaxPivot] as [Daily_CandleDiffFromLagMaxPivot],
D.[CandleDiffFromLagMinPivot] as [Daily_CandleDiffFromLagMinPivot],
D.[PivotToPivotMaxDegree] as [Daily_PivotToPivotMaxDegree],
D.[PivotToPivotMinDegree] as [Daily_PivotToPivotMinDegree],
D.[PivotToCurrentMaxDegree] as [Daily_PivotToCurrentMaxDegree],
D.[PivotToCurrentMinDegree] as [Daily_PivotToCurrentMinDegree],
D.[VolLagPercent] as [Daily_VolLagPercent],
D.[RSI14] as [Daily_RSI14],
D.[RSI5] as [Daily_RSI5],
D.[ID] as [Daily_ID],
D.[OBV] as [Daily_OBV],
D.[CCI] as [Daily_CCI],
D.[+Di14] as [Daily_+Di14],
D.[-Di14] as [Daily_-Di14],
D.[ADX] as [Daily_ADX],
D.[IsBiggerThanMaxPrice3] as [Daily_IsBiggerThanMaxPrice3],
D.[IsBiggerThanMaxPrice5] as [Daily_IsBiggerThanMaxPrice5],
D.[IsBiggerThanMaxPrice8] as [Daily_IsBiggerThanMaxPrice8],
D.[IsBiggerThanMaxPrice13] as [Daily_IsBiggerThanMaxPrice13],
D.[IsBiggerThanMaxPrice34] as [Daily_IsBiggerThanMaxPrice34],
D.[IsLessThanMinPrice3] as [Daily_IsLessThanMinPrice3],
D.[IsLessThanMinPrice5] as [Daily_IsLessThanMinPrice5],
D.[IsLessThanMinPrice8] as [Daily_IsLessThanMinPrice8],
D.[IsLessThanMinPrice13] as [Daily_IsLessThanMinPrice13],
D.[IsLessThanMinPrice34] as [Daily_IsLessThanMinPrice34],
D.[ResistantDistanceMaxPrice3] as [Daily_ResistantDistanceMaxPrice3],
D.[ResistantDistancePrice5] as [Daily_ResistantDistancePrice5],
D.[ResistantDistancePrice8] as [Daily_ResistantDistancePrice8],
D.[ResistantDistancePrice13] as [Daily_ResistantDistancePrice13],
D.[ResistantDistancePrice34] as [Daily_ResistantDistancePrice34],
D.[SupportDistanceMinPrice3] as [Daily_SupportDistanceMinPrice3],
D.[SupportDistanceMinPrice5] as [Daily_SupportDistanceMinPrice5],
D.[SupportDistanceMinPrice8] as [Daily_SupportDistanceMinPrice8],
D.[SupportDistanceMinPrice13] as [Daily_SupportDistanceMinPrice13],
D.[SupportDistanceMinPrice34] as [Daily_SupportDistanceMinPrice34],
D.[SMA] as [Daily_SMA],
D.[EMA] as [Daily_EMA],
D.[DiffSmaEmaOverClosePrcnt] as [Daily_DiffSmaEmaOverClosePrcnt],
D.[IsSmaOveEma] as [Daily_IsSmaOveEma],
D.[SmaDegree] as [Daily_SmaDegree],
D.[EmaDegree] as [Daily_EmaDegree],
D.[IsRed] as [Daily_IsRed],
D.[IsGreen] as [Daily_IsGreen],
D.[_PriceRange] as [Daily__PriceRange],
D.[PriceRangeWidthPrcnt] as [Daily_PriceRangeWidthPrcnt],
D.[MiddleBodyPrice] as [Daily_MiddleBodyPrice],
D.[MiddleFullPrice] as [Daily_MiddleFullPrice],
D.[ResistantDistancePrcnt] as [Daily_ResistantDistancePrcnt],
D.[SupportDistancePrcnt] as [Daily_SupportDistancePrcnt],
D.[FloorToCieling] as [Daily_FloorToCieling],
D.[CandleBodyRangeWidthPrcnt] as [Daily_CandleBodyRangeWidthPrcnt],
D.[_CloseOpenPrcnt] as [Daily__CloseOpenPrcnt],
D.[_HighCielingPrcnt] as [Daily__HighCielingPrcnt],
D.[_FloorLowPrcnt] as [Daily__FloorLowPrcnt],
D.[OneLagIsRed] as [Daily_OneLagIsRed],
D.[OneLagIsGreen] as [Daily_OneLagIsGreen],
D.[OneLagCandleCeiling] as [Daily_OneLagCandleCeiling],
D.[OneLagCandleFloor] as [Daily_OneLagCandleFloor],
D.[OneLagHigh] as [Daily_OneLagHigh],
D.[OneLagLow] as [Daily_OneLagLow],
D.[OneCandleBodyRangeWidthPrcnt] as [Daily_OneCandleBodyRangeWidthPrcnt],
D.[OneFloorToCieling] as [Daily_OneFloorToCieling],
D.[MonsterCandle_Bullish] as [Daily_MonsterCandle_Bullish],
D.[MonsterCandle_Bearish] as [Daily_MonsterCandle_Bearish],
D.[UHAMMER] as [Daily_UHAMMER],
D.[LHAMMER] as [Daily_LHAMMER],
D.[IsSharkZone] as [Daily_IsSharkZone],
H4.[RowNo] as [H4_RowNo],
H4.[Open] as [H4_Open],
H4.[High] as [H4_High],
H4.[Low] as [H4_Low],
H4.[Close] as [H4_Close],
H4.[CandleCeiling] as [H4_CandleCeiling],
H4.[CandleFloor] as [H4_CandleFloor],
H4.[Volume] as [H4_Volume],
H4.[DateID] as [H4_DateID],
H4.[MaxBetween] as [H4_MaxBetween],
H4.[MinBetween] as [H4_MinBetween],
H4.[Endt] as [H4_Endt],
H4.[MX] as [H4_MX],
H4.[Min] as [H4_Min],
H4.[EnDay] as [H4_EnDay],
H4.[EnMonthName] as [H4_EnMonthName],
H4.[EnYear] as [H4_EnYear],
H4.[lgMax] as [H4_lgMax],
H4.[LgMin] as [H4_LgMin],
H4.[ClosePriceDiffLgMin] as [H4_ClosePriceDiffLgMin],
H4.[ClosePriceDiffLgMax] as [H4_ClosePriceDiffLgMax],
H4.[HighPriceDiffLgMin] as [H4_HighPriceDiffLgMin],
H4.[HighPriceDiffLgMax] as [H4_HighPriceDiffLgMax],
H4.[LowPriceDiffLgMin] as [H4_LowPriceDiffLgMin],
H4.[LowPriceDiffLgMax] as [H4_LowPriceDiffLgMax],
H4.[CandleDiffFromLagMaxPivot] as [H4_CandleDiffFromLagMaxPivot],
H4.[CandleDiffFromLagMinPivot] as [H4_CandleDiffFromLagMinPivot],
H4.[PivotToPivotMaxDegree] as [H4_PivotToPivotMaxDegree],
H4.[PivotToPivotMinDegree] as [H4_PivotToPivotMinDegree],
H4.[PivotToCurrentMaxDegree] as [H4_PivotToCurrentMaxDegree],
H4.[PivotToCurrentMinDegree] as [H4_PivotToCurrentMinDegree],
H4.[VolLagPercent] as [H4_VolLagPercent],
H4.[RSI14] as [H4_RSI14],
H4.[RSI5] as [H4_RSI5],
H4.[ID] as [H4_ID],
H4.[OBV] as [H4_OBV],
H4.[CCI] as [H4_CCI],
H4.[+Di14] as [H4_+Di14],
H4.[-Di14] as [H4_-Di14],
H4.[ADX] as [H4_ADX],
H4.[IsBiggerThanMaxPrice3] as [H4_IsBiggerThanMaxPrice3],
H4.[IsBiggerThanMaxPrice5] as [H4_IsBiggerThanMaxPrice5],
H4.[IsBiggerThanMaxPrice8] as [H4_IsBiggerThanMaxPrice8],
H4.[IsBiggerThanMaxPrice13] as [H4_IsBiggerThanMaxPrice13],
H4.[IsBiggerThanMaxPrice34] as [H4_IsBiggerThanMaxPrice34],
H4.[IsLessThanMinPrice3] as [H4_IsLessThanMinPrice3],
H4.[IsLessThanMinPrice5] as [H4_IsLessThanMinPrice5],
H4.[IsLessThanMinPrice8] as [H4_IsLessThanMinPrice8],
H4.[IsLessThanMinPrice13] as [H4_IsLessThanMinPrice13],
H4.[IsLessThanMinPrice34] as [H4_IsLessThanMinPrice34],
H4.[ResistantDistanceMaxPrice3] as [H4_ResistantDistanceMaxPrice3],
H4.[ResistantDistancePrice5] as [H4_ResistantDistancePrice5],
H4.[ResistantDistancePrice8] as [H4_ResistantDistancePrice8],
H4.[ResistantDistancePrice13] as [H4_ResistantDistancePrice13],
H4.[ResistantDistancePrice34] as [H4_ResistantDistancePrice34],
H4.[SupportDistanceMinPrice3] as [H4_SupportDistanceMinPrice3],
H4.[SupportDistanceMinPrice5] as [H4_SupportDistanceMinPrice5],
H4.[SupportDistanceMinPrice8] as [H4_SupportDistanceMinPrice8],
H4.[SupportDistanceMinPrice13] as [H4_SupportDistanceMinPrice13],
H4.[SupportDistanceMinPrice34] as [H4_SupportDistanceMinPrice34],
H4.[SMA] as [H4_SMA],
H4.[EMA] as [H4_EMA],
H4.[DiffSmaEmaOverClosePrcnt] as [H4_DiffSmaEmaOverClosePrcnt],
H4.[IsSmaOveEma] as [H4_IsSmaOveEma],
H4.[SmaDegree] as [H4_SmaDegree],
H4.[EmaDegree] as [H4_EmaDegree],
H4.[IsRed] as [H4_IsRed],
H4.[IsGreen] as [H4_IsGreen],
H4.[_PriceRange] as [H4__PriceRange],
H4.[PriceRangeWidthPrcnt] as [H4_PriceRangeWidthPrcnt],
H4.[MiddleBodyPrice] as [H4_MiddleBodyPrice],
H4.[MiddleFullPrice] as [H4_MiddleFullPrice],
H4.[ResistantDistancePrcnt] as [H4_ResistantDistancePrcnt],
H4.[SupportDistancePrcnt] as [H4_SupportDistancePrcnt],
H4.[FloorToCieling] as [H4_FloorToCieling],
H4.[CandleBodyRangeWidthPrcnt] as [H4_CandleBodyRangeWidthPrcnt],
H4.[_CloseOpenPrcnt] as [H4__CloseOpenPrcnt],
H4.[_HighCielingPrcnt] as [H4__HighCielingPrcnt],
H4.[_FloorLowPrcnt] as [H4__FloorLowPrcnt],
H4.[OneLagIsRed] as [H4_OneLagIsRed],
H4.[OneLagIsGreen] as [H4_OneLagIsGreen],
H4.[OneLagCandleCeiling] as [H4_OneLagCandleCeiling],
H4.[OneLagCandleFloor] as [H4_OneLagCandleFloor],
H4.[OneLagHigh] as [H4_OneLagHigh],
H4.[OneLagLow] as [H4_OneLagLow],
H4.[OneCandleBodyRangeWidthPrcnt] as [H4_OneCandleBodyRangeWidthPrcnt],
H4.[OneFloorToCieling] as [H4_OneFloorToCieling],
H4.[MonsterCandle_Bullish] as [H4_MonsterCandle_Bullish],
H4.[MonsterCandle_Bearish] as [H4_MonsterCandle_Bearish],
H4.[UHAMMER] as [H4_UHAMMER],
H4.[LHAMMER] as [H4_LHAMMER],
H1.[RowNo] as [H1_RowNo],
H1.[Open] as [H1_Open],
H1.[High] as [H1_High],
H1.[Low] as [H1_Low],
H1.[Close] as [H1_Close],
H1.[CandleCeiling] as [H1_CandleCeiling],
H1.[CandleFloor] as [H1_CandleFloor],
H1.[Volume] as [H1_Volume],
H1.[DateID] as [H1_DateID],
H1.[MaxBetween] as [H1_MaxBetween],
H1.[MinBetween] as [H1_MinBetween],
H1.[Endt] as [H1_Endt],
H1.[MX] as [H1_MX],
H1.[Min] as [H1_Min],
H1.[EnDay] as [H1_EnDay],
H1.[EnMonthName] as [H1_EnMonthName],
H1.[EnYear] as [H1_EnYear],
H1.[lgMax] as [H1_lgMax],
H1.[LgMin] as [H1_LgMin],
H1.[ClosePriceDiffLgMin] as [H1_ClosePriceDiffLgMin],
H1.[ClosePriceDiffLgMax] as [H1_ClosePriceDiffLgMax],
H1.[HighPriceDiffLgMin] as [H1_HighPriceDiffLgMin],
H1.[HighPriceDiffLgMax] as [H1_HighPriceDiffLgMax],
H1.[LowPriceDiffLgMin] as [H1_LowPriceDiffLgMin],
H1.[LowPriceDiffLgMax] as [H1_LowPriceDiffLgMax],
H1.[CandleDiffFromLagMaxPivot] as [H1_CandleDiffFromLagMaxPivot],
H1.[CandleDiffFromLagMinPivot] as [H1_CandleDiffFromLagMinPivot],
H1.[PivotToPivotMaxDegree] as [H1_PivotToPivotMaxDegree],
H1.[PivotToPivotMinDegree] as [H1_PivotToPivotMinDegree],
H1.[PivotToCurrentMaxDegree] as [H1_PivotToCurrentMaxDegree],
H1.[PivotToCurrentMinDegree] as [H1_PivotToCurrentMinDegree],
H1.[VolLagPercent] as [H1_VolLagPercent],
H1.[RSI14] as [H1_RSI14],
H1.[RSI5] as [H1_RSI5],
H1.[ID] as [H1_ID],
H1.[OBV] as [H1_OBV],
H1.[CCI] as [H1_CCI],
H1.[+Di14] as [H1_+Di14],
H1.[-Di14] as [H1_-Di14],
H1.[ADX] as [H1_ADX],
H1.[IsBiggerThanMaxPrice3] as [H1_IsBiggerThanMaxPrice3],
H1.[IsBiggerThanMaxPrice5] as [H1_IsBiggerThanMaxPrice5],
H1.[IsBiggerThanMaxPrice8] as [H1_IsBiggerThanMaxPrice8],
H1.[IsBiggerThanMaxPrice13] as [H1_IsBiggerThanMaxPrice13],
H1.[IsBiggerThanMaxPrice34] as [H1_IsBiggerThanMaxPrice34],
H1.[IsLessThanMinPrice3] as [H1_IsLessThanMinPrice3],
H1.[IsLessThanMinPrice5] as [H1_IsLessThanMinPrice5],
H1.[IsLessThanMinPrice8] as [H1_IsLessThanMinPrice8],
H1.[IsLessThanMinPrice13] as [H1_IsLessThanMinPrice13],
H1.[IsLessThanMinPrice34] as [H1_IsLessThanMinPrice34],
H1.[ResistantDistanceMaxPrice3] as [H1_ResistantDistanceMaxPrice3],
H1.[ResistantDistancePrice5] as [H1_ResistantDistancePrice5],
H1.[ResistantDistancePrice8] as [H1_ResistantDistancePrice8],
H1.[ResistantDistancePrice13] as [H1_ResistantDistancePrice13],
H1.[ResistantDistancePrice34] as [H1_ResistantDistancePrice34],
H1.[SupportDistanceMinPrice3] as [H1_SupportDistanceMinPrice3],
H1.[SupportDistanceMinPrice5] as [H1_SupportDistanceMinPrice5],
H1.[SupportDistanceMinPrice8] as [H1_SupportDistanceMinPrice8],
H1.[SupportDistanceMinPrice13] as [H1_SupportDistanceMinPrice13],
H1.[SupportDistanceMinPrice34] as [H1_SupportDistanceMinPrice34],
H1.[SMA] as [H1_SMA],
H1.[EMA] as [H1_EMA],
H1.[DiffSmaEmaOverClosePrcnt] as [H1_DiffSmaEmaOverClosePrcnt],
H1.[IsSmaOveEma] as [H1_IsSmaOveEma],
H1.[SmaDegree] as [H1_SmaDegree],
H1.[EmaDegree] as [H1_EmaDegree],
H1.[IsRed] as [H1_IsRed],
H1.[IsGreen] as [H1_IsGreen],
H1.[_PriceRange] as [H1__PriceRange],
H1.[PriceRangeWidthPrcnt] as [H1_PriceRangeWidthPrcnt],
H1.[MiddleBodyPrice] as [H1_MiddleBodyPrice],
H1.[MiddleFullPrice] as [H1_MiddleFullPrice],
H1.[ResistantDistancePrcnt] as [H1_ResistantDistancePrcnt],
H1.[SupportDistancePrcnt] as [H1_SupportDistancePrcnt],
H1.[FloorToCieling] as [H1_FloorToCieling],
H1.[CandleBodyRangeWidthPrcnt] as [H1_CandleBodyRangeWidthPrcnt],
H1.[_CloseOpenPrcnt] as [H1__CloseOpenPrcnt],
H1.[_HighCielingPrcnt] as [H1__HighCielingPrcnt],
H1.[_FloorLowPrcnt] as [H1__FloorLowPrcnt],
H1.[OneLagIsRed] as [H1_OneLagIsRed],
H1.[OneLagIsGreen] as [H1_OneLagIsGreen],
H1.[OneLagCandleCeiling] as [H1_OneLagCandleCeiling],
H1.[OneLagCandleFloor] as [H1_OneLagCandleFloor],
H1.[OneLagHigh] as [H1_OneLagHigh],
H1.[OneLagLow] as [H1_OneLagLow],
H1.[OneCandleBodyRangeWidthPrcnt] as [H1_OneCandleBodyRangeWidthPrcnt],
H1.[OneFloorToCieling] as [H1_OneFloorToCieling],
H1.[MonsterCandle_Bullish] as [H1_MonsterCandle_Bullish],
H1.[MonsterCandle_Bearish] as [H1_MonsterCandle_Bearish],
H1.[UHAMMER] as [H1_UHAMMER],
H1.[LHAMMER] as [H1_LHAMMER],
H1.[IsSharkZone] as [H1_IsSharkZone]
into ##ResToCsv
from  w
inner join ResDay d on  d.Endt between w.Endt and WToDate
inner join h4 on d.Endt = h4.Endt 
inner join H1  on d.Endt = h1.Endt and h1.FromHH between h4.FromHH and h4.ToHH

select * from ##ResToCsv
order by [Week_RowNo],[Daily_RowNo],H4_RowNo,H1_RowNo
